<%- include("../include/head.ejs") %>
  <%- include("../include/navebar.ejs") %>
    <%- include("../include/notification.ejs") %>
      <style>
        /* body {
          background-color: #B8B4EC;
        } */

        h1.text-center {
          color: #fff;
          font-size: 36px;
          text-align: center;
          margin-bottom: 30px;
          text-transform: uppercase;
          letter-spacing: 2px;
          background: linear-gradient(90deg, #776bcc, #4c489d);
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          font-weight: bold;
          text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
      </style>
      <div class="results py-5">
        <div class="container">
          <h1 class="text-center mb-4">Test Results (<span>
              <%= user.name %>
            </span>)</h1>
          <% if (AllUserResult.length> 0) { %>
            <% AllUserResult.forEach(exam=> { %>
              <div class="card mb-4 shadow-sm">
                <div class="card-header text-white" style="background-color: #6c63ac;">
                  <h4 class="mb-0">Exam Name : <span class="text-capitalize">
                      <%= exam.examName %>
                    </span></h4>
                </div>
                <div class="card-body">
                  <% exam.attempts.forEach(attempt=> { %>
                    <div class="mb-3">
                      <h5 class="text-secondary">Attempt Date: <%= attempt.examDate %>
                      </h5>
                      <table class="table table-bordered text-center">
                        <thead class="thead-dark">
                          <tr>
                            <th>Section</th>
                            <th>Date</th>
                            <th>Total Score</th>
                            <th>Degree Earned</th>
                            <th>Active</th>
                          </tr>
                        </thead>
                        <tbody>
                          <% attempt.sections.forEach(section=> { %>
                            <tr>
                              <td class="text-uppercase">
                                <%= section.sectionName %>
                              </td>
                              <td>
                                <%= section.sectionDate %>
                              </td>
                              <td>
                                <%= section.degreeFrom %>
                              </td>
                              <td>
                                <%= section.obtainedDegree %>
                              </td>
                              <td>
                                <% if (section.obtainedDegree>= section.degreeFrom * 0.5) { %>
                                  <span class="badge badge-success">Successful</span>
                                  <% } else { %>
                                    <span class="badge badge-danger">Un Successful</span>
                                    <% } %>
                              </td>
                            </tr>
                            <% }) %>
                        </tbody>
                      </table>
                    </div>
                    <% }) %>
                </div>
              </div>
              <% }) %>
                <% } else { %>
                  <div class="alert alert-warning text-center">
                    There are no test results yet.
                  </div>
                  <% } %>
        </div>
      </div>

      <%- include("../include/footer.ejs") %>
        <%- include("../include/footerScript.ejs") %>
          <script src="/frontEnd/assets/js/main.js"></script>